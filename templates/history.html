{% extends 'base.html' %}
{% block title %}History | Mask Detection Platform{% endblock %}
{% block content %}
<div class="main-card">
    <h1>Detection History</h1>
    <button id="clear-history-btn" style="float:right;margin-bottom:12px;background:#d32f2f;color:#fff;border:none;padding:8px 18px;border-radius:6px;cursor:pointer;">Clear History</button>
    <table id="history-table" style="width:100%;margin-top:24px;border-collapse:collapse;">
        <thead>
            <tr style="background:var(--bg);color:var(--primary);font-weight:bold;">
                <th style="padding:8px;">Time</th>
                <th style="padding:8px;">With Mask</th>
                <th style="padding:8px;">Without Mask</th>
                <th style="padding:8px;">Incorrect Mask</th>
                <th style="padding:8px;">Total</th>
            </tr>
        </thead>
        <tbody id="history-body">
            {% if history and history|length > 0 %}
                {% for entry in history|reverse %}
                <tr>
                    <td style="padding:8px;">{{ entry.timestamp }}</td>
                    <td style="padding:8px;">{{ entry.with_mask }}</td>
                    <td style="padding:8px;">{{ entry.without_mask }}</td>
                    <td style="padding:8px;">{{ entry.mask_weared_incorrect }}</td>
                    <td style="padding:8px;">{{ entry.with_mask + entry.without_mask + entry.mask_weared_incorrect }}</td>
                </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="5" style="padding:18px;text-align:center;color:var(--text);">No data available yet.</td></tr>
            {% endif %}
        </tbody>
    </table>
</div>
<script>
    document.getElementById('clear-history-btn').onclick = function() {
        if (confirm('Are you sure you want to clear the detection history?')) {
            fetch('/clear_history', {method: 'POST'})
                .then(res => res.json())
                .then(data => { if(data.status === 'cleared') location.reload(); });
        }
    };
</script>
{% endblock %} 